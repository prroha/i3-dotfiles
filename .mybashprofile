# Java (auto-detect latest openjdk)
JAVA_DIR=$(ls -d /usr/lib/jvm/java-*-openjdk 2>/dev/null | sort -V | tail -1)
if [ -n "$JAVA_DIR" ]; then
    export JAVA_HOME="$JAVA_DIR"
    export PATH=$JAVA_HOME/bin:$PATH
fi

# LazyVim alias
alias lazy='NVIM_APPNAME=lazynvim nvim'

# Optional software (only alias if installed)
[ -x /opt/intellij/bin/idea ] && alias idea='/opt/intellij/bin/idea'
[ -x /opt/Rider/bin/rider.sh ] && alias rider='/opt/Rider/bin/rider.sh'
[ -f /opt/mendeley.AppImage ] && alias mendeley='/opt/mendeley.AppImage'
[ -d /opt/mongodb/bin ] && export PATH="/opt/mongodb/bin:$PATH"

# xdg-open shortcut
alias open='xdg-open'

# Quick command cheatsheet
alias cheat='cat ~/dotfiles/cheatsheet'

# Add ssh key (only if keychain and key exist)
if command -v keychain &>/dev/null; then
    for key in ~/.ssh/id_* ~/.ssh/*-ssh-key; do
        if [ -f "$key" ] && [[ "$key" != *.pub ]]; then
            eval "$(keychain --eval --agents ssh "$(basename "$key")")"
            break
        fi
    done
fi

#Map podman to docker
alias docker=podman
alias docker-compose=podman-compose

# Yazi file manager
alias dir='yazi'

# Yazi: cd to last directory on quit (press q)
function y() {
	local tmp="$(mktemp -t "yazi-cwd.XXXXXX")" cwd
	yazi "$@" --cwd-file="$tmp"
	if cwd="$(command cat -- "$tmp")" && [ -n "$cwd" ] && [ "$cwd" != "$PWD" ]; then
		builtin cd -- "$cwd"
	fi
	rm -f -- "$tmp"
}

# Zoxide â€” smarter cd (use 'z' instead of 'cd')
eval "$(zoxide init bash)"

# Lazydocker (via Podman socket)
export DOCKER_HOST=unix:///run/user/$(id -u)/podman/podman.sock
alias lzd='lazydocker'

# Dev stack (postgres + redis)
alias devup='podman-compose -f ~/devstack/docker-compose.yml up -d'
alias devdown='podman-compose -f ~/devstack/docker-compose.yml down'
alias devps='podman-compose -f ~/devstack/docker-compose.yml ps'

# Additional PATHs
export PATH=$PATH:/usr/local/bin
export PATH=$HOME/.npm-global/bin:$PATH
export PATH="$PATH:$HOME/flutter/bin"
export ANDROID_HOME="$HOME/android-sdk"
export PATH="$ANDROID_HOME/cmdline-tools/latest/bin:$ANDROID_HOME/platform-tools:$PATH"

